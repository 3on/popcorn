var Component=require("montage/ui/component").Component,Remotemediator=require("model/remotemediator").Remotemediator,AppData=require("model/appdata").AppData;exports.Main=Component.specialize({appData:{value:AppData.create()},remoteMediator:{value:Remotemediator.create()},categoryId:{value:null},_categoryButtonGroup:{value:null},constructor:{value:function(){this.application.addEventListener("remoteDataReceived",this,!1),this.application.addEventListener("openTrailer",this,!1),this.canDrawGate.setField("latestBoxofficeMovies",!1),this.remoteMediator.load()}},templateDidLoad:{value:function(){var e=this.templateObjects;this._categoryButtonGroup=[e.latest,e.theaters,e.dvd,e.upcoming]}},handleRemoteDataReceived:{value:function(e){var t=e.detail.data,a=e.detail.type;this.appData[a]=t,"latestBoxofficeMovies"===a&&(this.canDrawGate.setField("latestBoxofficeMovies",!0),this.dispatchEventNamed("dataReceived",!0),this.changeCategory(a))}},handleOpenTrailer:{value:function(e){var t=e.detail,a=this.templateObjects.popup;this.remoteMediator.searchYoutubeTrailer(t,function(e){a.openTrailer(e)})}},handleCategoryButtonAction:{value:function(e){this.changeCategory(e.target.category)}},changeCategory:{value:function(e){var t=this._categoryButtonGroup;this.categoryId=e;for(var a=0;t.length>a;a++)t[a].pressed=t[a].category===e}},_windowScroll:{value:function(e){(window.innerHeight===window.outerHeight||window.innerHeight!==this._element.offsetHeight)&&(window.scrollTo(0,0),e.templateObjects.facadeflow.flow.handleResize(),window.clearTimeout(e._windowScrollTimeout),e._windowScrollTimeout=window.setTimeout(function(){e._windowScroll(e)},700))}},_windowScrollTimeout:{value:null},handleOrientationchange:{value:function(){var e=this;window.scrollTo(0,0),navigator.userAgent.match(/(iPhone|iPod touch);.*CPU.*OS 7_0_\d/i)&&(window.clearTimeout(this._windowScrollTimeout),90===Math.abs(window.orientation)&&(e._windowScrollTimeout=window.setTimeout(function(){e._windowScroll(e)},1e3)))}},enterDocument:{value:function(e){e&&window.addEventListener("orientationchange",this,!1)}}});